% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/remove_halo_bleed_wiener.R
\name{estimate_psf_from_peaks}
\alias{estimate_psf_from_peaks}
\title{Estimate Point Spread Function from Peak Intensity Centering}
\usage{
estimate_psf_from_peaks(
  img,
  colony_data,
  background_img,
  activity_percentile = 0.9,
  psf_radius = 15,
  invert_for_clearing = TRUE
)
}
\arguments{
\item{img}{`cimg`. Washed image object from the imager package.}

\item{colony_data}{`data.frame`. Colony data with bounding box coordinates.}

\item{background_img}{`cimg`. Background image for activity calculation.}

\item{activity_percentile}{`numeric(1)`. Percentile threshold for selecting
highly active colonies. Default is 0.9.}

\item{psf_radius}{`numeric(1)`. Radius of the PSF in pixels. Default is 15.}

\item{invert_for_clearing}{`logical(1)`. Whether to invert intensities for
clearing assays. Default is TRUE.}
}
\value{
A normalized `matrix` representing the estimated point spread function.
}
\description{
Identifies highly active colonies and extracts PSF by centering on peak
intensities within each colony region. Accumulates and averages PSF patterns
from multiple colonies to create a robust estimate of the optical blur.
}
